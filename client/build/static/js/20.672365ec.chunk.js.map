{"version":3,"sources":["pages/paymentSuccess/paymentSuccess.module.css","pages/paymentSuccess/paymentSuccess.js"],"names":["module","exports","PaymentSuccess","props","useEffect","document","title","window","scrollTo","navigate","useNavigate","login","useSelector","state","loggedin","address","localStorage","getItem","JSON","parse","pin","replace","userSub","userData","useState","orders","setOrders","dispatch","useDispatch","email","a","cart","bill","fetch","method","headers","body","stringify","res","json","data","ok","getOrders","className","classes","layout","badge","onClick","event","amount","products","currOrder","slice","push","order_id","status","payment","date","postOrders","addressActions","remAddress","continue","subHead"],"mappings":"sGACAA,EAAOC,QAAU,CAAC,MAAQ,8BAA8B,SAAW,iCAAiC,OAAS,+BAA+B,QAAU,kC,2IC6GvIC,UAtGf,SAAwBC,GAEpBC,qBAAU,WACNC,SAASC,MAAQ,qDACjBC,OAAOC,SAAS,EAAG,MAIvB,IAAIC,EAAWC,cACTC,EAAQC,aAAY,SAACC,GAAD,OAAWA,EAAMF,MAAMG,YAEjDV,qBAAU,WAEN,IAAMW,EAAUC,aAAaC,QAAQ,WAAaC,KAAKC,MAAMH,aAAaC,QAAQ,YAAc,GAE5FN,GAAUI,EAAQK,KAClBX,EAAS,IAAK,CAAEY,SAAS,MAE9B,CAACZ,EAAUE,IAGd,IAAMW,EAAUV,aAAY,SAACC,GAAD,OAAWA,EAAMF,MAAMY,YAEnD,EAA4BC,mBAAS,IAArC,mBAAOC,EAAP,KAAeC,EAAf,KACMC,EAAWC,cAxBS,4CAkD1B,WAA0BC,EAAOJ,GAAjC,mBAAAK,EAAA,6DAEUC,EAAO,GACPC,EAAO,GAHjB,SAIsBC,MAAM,2BAA4B,CAChDC,OAAQ,OACRC,QAAQ,CACJ,eAAgB,oBAEpBC,KAAMlB,KAAKmB,UAAU,CAAER,QAAOE,OAAMC,OAAMP,aATlD,cAIUa,EAJV,gBAYUA,EAAIC,OAZd,2CAlD0B,wBA4F1B,OAlEAnC,qBAAU,WAAK,4CAGX,WAAyByB,GAAzB,iBAAAC,EAAA,sEAEsBG,MAAM,wBAAyB,CAC7CC,OAAQ,OACRC,QAAQ,CACJ,eAAgB,oBAEpBC,KAAMlB,KAAKmB,UAAU,CAAER,YAP/B,cAEUS,EAFV,gBAUuBA,EAAIC,OAV3B,OAUUC,EAVV,OAYOF,EAAIG,IAAMD,EAAKf,QACdC,EAAUc,EAAKf,QAbvB,4CAHW,2DAmBXiB,CAAUpB,EAAQO,SAEnB,CAACP,EAAQO,QA8CR,sBAAKc,UAAWC,IAAQC,OAAxB,UACI,8BAAK,sBAAMF,UAAWC,IAAQE,MAAzB,SAAgC,cAAC,IAAD,QACrC,oDACA,wBAAQC,QA9BhB,SAAiBC,GAEb,IAAMhB,EAAOhB,aAAaC,QAAQ,aAAeC,KAAKC,MAAMH,aAAaC,QAAQ,cAAgB,CAAC,CAACgC,OAAQ,IACrGC,EAAWlC,aAAaC,QAAQ,YAAcC,KAAKC,MAAMH,aAAaC,QAAQ,aAAe,GAC7FF,EAAUC,aAAaC,QAAQ,WAAaC,KAAKC,MAAMH,aAAaC,QAAQ,YAAc,GAE5FkC,EAAY1B,EAAO2B,QACnBD,EAAUE,KAAK,CACXC,SAAU,GACVC,OAAQ,aACRvB,KAAMA,EACNkB,SAAUA,EACVM,QAAS,SACTzC,QAASA,EACT0C,KAAM,KAhFQ,sCAmFtBC,CAAWpC,EAAQO,MAAOsB,GAE1BxB,EAASgC,IAAeC,cAExBnD,EAAS,UAAW,CAAEY,SAAS,KASCsB,UAAWC,IAAQiB,SAA/C,sBACA,mBAAGlB,UAAWC,IAAQkB,QAAtB","file":"static/js/20.672365ec.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"badge\":\"paymentSuccess_badge__2LODo\",\"continue\":\"paymentSuccess_continue__35gKk\",\"layout\":\"paymentSuccess_layout__2_Ues\",\"subHead\":\"paymentSuccess_subHead__2hCKQ\"};","import React, { useState, useEffect } from 'react';\r\n\r\nimport { useNavigate } from 'react-router-dom';\r\nimport BadgeCheckIcon from '../../icons/badgeCheckIcon';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { addressActions } from '../../store/addressStore';\r\nimport classes from './paymentSuccess.module.css';\r\n\r\nfunction PaymentSuccess(props){\r\n\r\n    useEffect(() => {\r\n        document.title = 'Online Shopping site for shoes in India | Friction';\r\n        window.scrollTo(0, 0);\r\n    });\r\n\r\n\r\n    let navigate = useNavigate();\r\n    const login = useSelector((state) => state.login.loggedin);\r\n\r\n    useEffect(() =>{\r\n\r\n        const address = localStorage.getItem(\"address\") ? JSON.parse(localStorage.getItem(\"address\")) : {};\r\n\r\n        if(!login || !address.pin)\r\n            navigate(`/`, { replace: true });\r\n\r\n    }, [navigate, login]);\r\n\r\n    \r\n    const userSub = useSelector((state) => state.login.userData);\r\n\r\n    const [orders, setOrders] = useState([]);\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() =>{\r\n\r\n         //get orders data mongodb\r\n        async function getOrders(email){\r\n\r\n            const res = await fetch(\"/api/user/history-get\", {\r\n                method: \"POST\",\r\n                headers:{\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify({ email })\r\n            });\r\n        \r\n            const data = await res.json();\r\n                \r\n            if(res.ok && data.orders)\r\n                setOrders(data.orders);\r\n        }\r\n        \r\n        getOrders(userSub.email);\r\n        \r\n    }, [userSub.email]);\r\n\r\n    //post orders\r\n    async function postOrders(email, orders){\r\n\r\n        const cart = [];\r\n        const bill = [];\r\n        const res = await fetch(\"/api/user/history-create\", {\r\n            method: \"POST\",\r\n            headers:{\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({ email, cart, bill, orders })\r\n        });\r\n    \r\n        await res.json();\r\n    }\r\n\r\n\r\n    function toOrder(event){\r\n\r\n        const bill = localStorage.getItem(\"billStore\") ? JSON.parse(localStorage.getItem(\"billStore\")) : [{amount: 0}];\r\n        const products = localStorage.getItem(\"products\") ? JSON.parse(localStorage.getItem(\"products\")) : [];\r\n        const address = localStorage.getItem(\"address\") ? JSON.parse(localStorage.getItem(\"address\")) : {};\r\n\r\n        var currOrder = orders.slice();\r\n            currOrder.push({\r\n                order_id: \"\",\r\n                status: \"processing\",\r\n                bill: bill,\r\n                products: products,\r\n                payment: \"Online\",\r\n                address: address,\r\n                date: \"\"\r\n        });\r\n\r\n        postOrders(userSub.email, currOrder);\r\n\r\n        dispatch(addressActions.remAddress());\r\n\r\n        navigate(`/orders`, { replace: true });\r\n\r\n    }\r\n\r\n\r\n    return(\r\n        <div className={classes.layout}>\r\n            <div><span className={classes.badge}><BadgeCheckIcon /></span></div>\r\n            <p>Payment Successfull</p>\r\n            <button onClick = {toOrder} className={classes.continue}>CONTINUE</button>\r\n            <p className={classes.subHead}>Please do not go back or refresh page</p>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PaymentSuccess;"],"sourceRoot":""}