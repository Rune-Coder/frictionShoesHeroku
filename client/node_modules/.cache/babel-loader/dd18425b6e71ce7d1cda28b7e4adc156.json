{"ast":null,"code":"import _regeneratorRuntime from\"D:/Web Development/React-Project-1/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Web Development/React-Project-1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Web Development/React-Project-1/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import BadgeCheckIcon from'../../icons/badgeCheckIcon';import{useSelector,useDispatch}from'react-redux';import{addressActions}from'../../store/addressStore';import classes from'./paymentSuccess.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PaymentSuccess(props){useEffect(function(){document.title='Online Shopping site for shoes in India | Friction';window.scrollTo(0,0);});var navigate=useNavigate();var login=useSelector(function(state){return state.login.loggedin;});useEffect(function(){var address=localStorage.getItem(\"address\")?JSON.parse(localStorage.getItem(\"address\")):{};if(!login||!address.pin)navigate(\"/\",{replace:true});},[navigate,login]);var userSub=useSelector(function(state){return state.login.userData;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];var dispatch=useDispatch();useEffect(function(){//get orders data mongodb\nfunction getOrders(_x){return _getOrders.apply(this,arguments);}function _getOrders(){_getOrders=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/user/history-get\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email:email})});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;if(res.ok&&data.orders)setOrders(data.orders);case 7:case\"end\":return _context.stop();}}},_callee);}));return _getOrders.apply(this,arguments);}getOrders(userSub.email);},[userSub.email]);//post orders\nfunction postOrders(_x2,_x3){return _postOrders.apply(this,arguments);}function _postOrders(){_postOrders=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(email,orders){var cart,bill,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:cart=[];bill=[];_context2.next=4;return fetch(\"/api/user/history-create\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email:email,cart:cart,bill:bill,orders:orders})});case 4:res=_context2.sent;_context2.next=7;return res.json();case 7:case\"end\":return _context2.stop();}}},_callee2);}));return _postOrders.apply(this,arguments);}function toOrder(event){var bill=localStorage.getItem(\"billStore\")?JSON.parse(localStorage.getItem(\"billStore\")):[{amount:0}];var products=localStorage.getItem(\"products\")?JSON.parse(localStorage.getItem(\"products\")):[];var address=localStorage.getItem(\"address\")?JSON.parse(localStorage.getItem(\"address\")):{};var currOrder=orders.slice();currOrder.push({order_id:\"\",status:\"processing\",bill:bill,products:products,payment:\"Online\",address:address,date:\"\"});postOrders(userSub.email,currOrder);dispatch(addressActions.remAddress());navigate(\"/orders\",{replace:true});}return/*#__PURE__*/_jsxs(\"div\",{className:classes.layout,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{className:classes.badge,children:/*#__PURE__*/_jsx(BadgeCheckIcon,{})})}),/*#__PURE__*/_jsx(\"p\",{children:\"Payment Successfull\"}),/*#__PURE__*/_jsx(\"button\",{onClick:toOrder,className:classes.continue,children:\"CONTINUE\"}),/*#__PURE__*/_jsx(\"p\",{className:classes.subHead,children:\"Please do not go back or refresh page\"})]});}export default PaymentSuccess;","map":{"version":3,"sources":["D:/Web Development/React-Project-1/src/pages/paymentSuccess/paymentSuccess.js"],"names":["React","useState","useEffect","useNavigate","BadgeCheckIcon","useSelector","useDispatch","addressActions","classes","PaymentSuccess","props","document","title","window","scrollTo","navigate","login","state","loggedin","address","localStorage","getItem","JSON","parse","pin","replace","userSub","userData","orders","setOrders","dispatch","getOrders","email","fetch","method","headers","body","stringify","res","json","data","ok","postOrders","cart","bill","toOrder","event","amount","products","currOrder","slice","push","order_id","status","payment","date","remAddress","layout","badge","continue","subHead"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nimport { useNavigate } from 'react-router-dom';\r\nimport BadgeCheckIcon from '../../icons/badgeCheckIcon';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { addressActions } from '../../store/addressStore';\r\nimport classes from './paymentSuccess.module.css';\r\n\r\nfunction PaymentSuccess(props){\r\n\r\n    useEffect(() => {\r\n        document.title = 'Online Shopping site for shoes in India | Friction';\r\n        window.scrollTo(0, 0);\r\n    });\r\n\r\n\r\n    let navigate = useNavigate();\r\n    const login = useSelector((state) => state.login.loggedin);\r\n\r\n    useEffect(() =>{\r\n\r\n        const address = localStorage.getItem(\"address\") ? JSON.parse(localStorage.getItem(\"address\")) : {};\r\n\r\n        if(!login || !address.pin)\r\n            navigate(`/`, { replace: true });\r\n\r\n    }, [navigate, login]);\r\n\r\n    \r\n    const userSub = useSelector((state) => state.login.userData);\r\n\r\n    const [orders, setOrders] = useState([]);\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() =>{\r\n\r\n         //get orders data mongodb\r\n        async function getOrders(email){\r\n\r\n            const res = await fetch(\"/api/user/history-get\", {\r\n                method: \"POST\",\r\n                headers:{\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify({ email })\r\n            });\r\n        \r\n            const data = await res.json();\r\n                \r\n            if(res.ok && data.orders)\r\n                setOrders(data.orders);\r\n        }\r\n        \r\n        getOrders(userSub.email);\r\n        \r\n    }, [userSub.email]);\r\n\r\n    //post orders\r\n    async function postOrders(email, orders){\r\n\r\n        const cart = [];\r\n        const bill = [];\r\n        const res = await fetch(\"/api/user/history-create\", {\r\n            method: \"POST\",\r\n            headers:{\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({ email, cart, bill, orders })\r\n        });\r\n    \r\n        await res.json();\r\n    }\r\n\r\n\r\n    function toOrder(event){\r\n\r\n        const bill = localStorage.getItem(\"billStore\") ? JSON.parse(localStorage.getItem(\"billStore\")) : [{amount: 0}];\r\n        const products = localStorage.getItem(\"products\") ? JSON.parse(localStorage.getItem(\"products\")) : [];\r\n        const address = localStorage.getItem(\"address\") ? JSON.parse(localStorage.getItem(\"address\")) : {};\r\n\r\n        var currOrder = orders.slice();\r\n            currOrder.push({\r\n                order_id: \"\",\r\n                status: \"processing\",\r\n                bill: bill,\r\n                products: products,\r\n                payment: \"Online\",\r\n                address: address,\r\n                date: \"\"\r\n        });\r\n\r\n        postOrders(userSub.email, currOrder);\r\n\r\n        dispatch(addressActions.remAddress());\r\n\r\n        navigate(`/orders`, { replace: true });\r\n\r\n    }\r\n\r\n\r\n    return(\r\n        <div className={classes.layout}>\r\n            <div><span className={classes.badge}><BadgeCheckIcon /></span></div>\r\n            <p>Payment Successfull</p>\r\n            <button onClick = {toOrder} className={classes.continue}>CONTINUE</button>\r\n            <p className={classes.subHead}>Please do not go back or refresh page</p>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PaymentSuccess;"]},"metadata":{},"sourceType":"module"}